<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>App (opium.Opium__.App)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">opium</a> &#x00BB; <a href="../index.html">Opium__</a> &#x00BB; App</nav><h1>Module <code>Opium__.App</code></h1></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt><dd><p>An opium app is a simple builder wrapper around a rock app</p></dd></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-sexp_of_t"><a href="#val-sexp_of_t" class="anchor"></a><code><span class="keyword">val</span> sexp_of_t : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Ppx_sexp_conv_lib.Sexp.t</code></dt></dl></div></div></div><dl><dt class="spec value" id="val-empty"><a href="#val-empty" class="anchor"></a><code><span class="keyword">val</span> empty : <a href="index.html#type-t">t</a></code></dt><dd><p>A basic empty app</p></dd></dl><dl><dt class="spec type" id="type-builder"><a href="#type-builder" class="anchor"></a><code><span class="keyword">type</span> builder</code><code> = <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>A builder is a function that transforms an <code>app</code> by adding some functionality. Builders are usuallys composed with a base app using (|&gt;) to create a full app</p></dd></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-sexp_of_builder"><a href="#val-sexp_of_builder" class="anchor"></a><code><span class="keyword">val</span> sexp_of_builder : <a href="index.html#type-builder">builder</a> <span>&#45;&gt;</span> Ppx_sexp_conv_lib.Sexp.t</code></dt></dl></div></div></div><dl><dt class="spec value" id="val-port"><a href="#val-port" class="anchor"></a><code><span class="keyword">val</span> port : int <span>&#45;&gt;</span> <a href="index.html#type-builder">builder</a></code></dt><dt class="spec value" id="val-ssl"><a href="#val-ssl" class="anchor"></a><code><span class="keyword">val</span> ssl : <span>cert:string</span> <span>&#45;&gt;</span> <span>key:string</span> <span>&#45;&gt;</span> <a href="index.html#type-builder">builder</a></code></dt><dt class="spec value" id="val-cmd_name"><a href="#val-cmd_name" class="anchor"></a><code><span class="keyword">val</span> cmd_name : string <span>&#45;&gt;</span> <a href="index.html#type-builder">builder</a></code></dt></dl><dl><dt class="spec type" id="type-route"><a href="#type-route" class="anchor"></a><code><span class="keyword">type</span> route</code><code> = string <span>&#45;&gt;</span> <a href="../../../opium_kernel/Opium_kernel__Rock/Handler/index.html#type-t">Opium_kernel.Rock.Handler.t</a> <span>&#45;&gt;</span> <a href="index.html#type-builder">builder</a></code></dt><dd><p>A route is a function that returns a buidler that hooks up a handler to a url mapping</p></dd></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-sexp_of_route"><a href="#val-sexp_of_route" class="anchor"></a><code><span class="keyword">val</span> sexp_of_route : <a href="index.html#type-route">route</a> <span>&#45;&gt;</span> Ppx_sexp_conv_lib.Sexp.t</code></dt></dl></div></div></div><dl><dt class="spec value" id="val-not_found"><a href="#val-not_found" class="anchor"></a><code><span class="keyword">val</span> not_found : <a href="../../../opium_kernel/Opium_kernel__Rock/Handler/index.html#type-t">Opium_kernel.Rock.Handler.t</a> <span>&#45;&gt;</span> <a href="index.html#type-builder">builder</a></code></dt><dd><p><code>not_found</code> accepts a regular Opium handler that will be used instead of the default 404 handler.</p></dd></dl><dl><dt class="spec value" id="val-get"><a href="#val-get" class="anchor"></a><code><span class="keyword">val</span> get : <a href="index.html#type-route">route</a></code></dt><dd><p>Method specific routes</p></dd></dl><dl><dt class="spec value" id="val-post"><a href="#val-post" class="anchor"></a><code><span class="keyword">val</span> post : <a href="index.html#type-route">route</a></code></dt><dt class="spec value" id="val-delete"><a href="#val-delete" class="anchor"></a><code><span class="keyword">val</span> delete : <a href="index.html#type-route">route</a></code></dt><dt class="spec value" id="val-put"><a href="#val-put" class="anchor"></a><code><span class="keyword">val</span> put : <a href="index.html#type-route">route</a></code></dt><dt class="spec value" id="val-patch"><a href="#val-patch" class="anchor"></a><code><span class="keyword">val</span> patch : <a href="index.html#type-route">route</a></code></dt><dd><p>Less common method specific routes</p></dd></dl><dl><dt class="spec value" id="val-options"><a href="#val-options" class="anchor"></a><code><span class="keyword">val</span> options : <a href="index.html#type-route">route</a></code></dt><dt class="spec value" id="val-head"><a href="#val-head" class="anchor"></a><code><span class="keyword">val</span> head : <a href="index.html#type-route">route</a></code></dt><dt class="spec value" id="val-any"><a href="#val-any" class="anchor"></a><code><span class="keyword">val</span> any : <span>Cohttp.Code.meth list</span> <span>&#45;&gt;</span> <a href="index.html#type-route">route</a></code></dt><dd><p>any <code>methods</code> will bind a route to any http method inside of <code>methods</code></p></dd></dl><dl><dt class="spec value" id="val-all"><a href="#val-all" class="anchor"></a><code><span class="keyword">val</span> all : <a href="index.html#type-route">route</a></code></dt><dd><p>all <code>methods</code> will bind a route to a URL regardless of the http method. You may escape the actual method used from the request passed.</p></dd></dl><dl><dt class="spec value" id="val-action"><a href="#val-action" class="anchor"></a><code><span class="keyword">val</span> action : Cohttp.Code.meth <span>&#45;&gt;</span> <a href="index.html#type-route">route</a></code></dt><dt class="spec value" id="val-middleware"><a href="#val-middleware" class="anchor"></a><code><span class="keyword">val</span> middleware : <a href="../../../opium_kernel/Opium_kernel__Rock/Middleware/index.html#type-t">Opium_kernel.Rock.Middleware.t</a> <span>&#45;&gt;</span> <a href="index.html#type-builder">builder</a></code></dt><dt class="spec value" id="val-to_rock"><a href="#val-to_rock" class="anchor"></a><code><span class="keyword">val</span> to_rock : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../../opium_kernel/Opium_kernel__Rock/App/index.html#type-t">Opium_kernel.Rock.App.t</a></code></dt><dd><p>Convert an opium app to a rock app</p></dd></dl><dl><dt class="spec value" id="val-start"><a href="#val-start" class="anchor"></a><code><span class="keyword">val</span> start : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>unit Lwt.t</span></code></dt><dd><p>Start an opium server. The thread returned can be cancelled to shutdown the server</p></dd></dl><dl><dt class="spec value" id="val-run_command"><a href="#val-run_command" class="anchor"></a><code><span class="keyword">val</span> run_command : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Create a cmdliner command from an app and run lwt's event loop</p></dd></dl><dl><dt class="spec value" id="val-run_command'"><a href="#val-run_command'" class="anchor"></a><code><span class="keyword">val</span> run_command' : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>[&gt; <span>`Ok of <span>unit Lwt.t</span></span> <span>| `Error</span> <span>| `Not_running</span> ]</span></code></dt></dl><dl><dt class="spec type" id="type-body"><a href="#type-body" class="anchor"></a><code><span class="keyword">type</span> body</code> = <code>[ </code><table class="variant"><tr id="type-body.Html" class="anchored"><td class="def constructor"><a href="#type-body.Html" class="anchor"></a><code>| </code><code>`Html <span class="keyword">of</span> string</code></td></tr><tr id="type-body.Json" class="anchored"><td class="def constructor"><a href="#type-body.Json" class="anchor"></a><code>| </code><code>`Json <span class="keyword">of</span> Ezjsonm.t</code></td></tr><tr id="type-body.Xml" class="anchored"><td class="def constructor"><a href="#type-body.Xml" class="anchor"></a><code>| </code><code>`Xml <span class="keyword">of</span> string</code></td></tr><tr id="type-body.String" class="anchored"><td class="def constructor"><a href="#type-body.String" class="anchor"></a><code>| </code><code>`String <span class="keyword">of</span> string</code></td></tr><tr id="type-body.Streaming" class="anchored"><td class="def constructor"><a href="#type-body.Streaming" class="anchor"></a><code>| </code><code>`Streaming <span class="keyword">of</span> <span>string Lwt_stream.t</span></code></td></tr></table><code> ]</code></dt><dd><p>Convenience functions for a running opium app</p></dd></dl><dl><dt class="spec value" id="val-json_of_body_exn"><a href="#val-json_of_body_exn" class="anchor"></a><code><span class="keyword">val</span> json_of_body_exn : <a href="../../../opium_kernel/Opium_kernel__Rock/Request/index.html#type-t">Opium_kernel.Rock.Request.t</a> <span>&#45;&gt;</span> <span>Ezjsonm.t Lwt.t</span></code></dt><dt class="spec value" id="val-string_of_body_exn"><a href="#val-string_of_body_exn" class="anchor"></a><code><span class="keyword">val</span> string_of_body_exn : <a href="../../../opium_kernel/Opium_kernel__Rock/Request/index.html#type-t">Opium_kernel.Rock.Request.t</a> <span>&#45;&gt;</span> <span>string Lwt.t</span></code></dt><dt class="spec value" id="val-urlencoded_pairs_of_body"><a href="#val-urlencoded_pairs_of_body" class="anchor"></a><code><span class="keyword">val</span> urlencoded_pairs_of_body : <a href="../../../opium_kernel/Opium_kernel__Rock/Request/index.html#type-t">Opium_kernel.Rock.Request.t</a> <span>&#45;&gt;</span> <span><span><span>(string * <span>string list</span>)</span> list</span> Lwt.t</span></code></dt><dd><p>Parse a request body encoded according to the <code>application/x-www-form-urlencoded</code> content type (typically from POST requests with form data) into an association list of key-value pairs. An exception is raised on invalid data.</p></dd></dl><dl><dt class="spec value" id="val-param"><a href="#val-param" class="anchor"></a><code><span class="keyword">val</span> param : <a href="../../../opium_kernel/Opium_kernel__Rock/Request/index.html#type-t">Opium_kernel.Rock.Request.t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string</code></dt><dt class="spec value" id="val-splat"><a href="#val-splat" class="anchor"></a><code><span class="keyword">val</span> splat : <a href="../../../opium_kernel/Opium_kernel__Rock/Request/index.html#type-t">Opium_kernel.Rock.Request.t</a> <span>&#45;&gt;</span> <span>string list</span></code></dt><dt class="spec value" id="val-respond"><a href="#val-respond" class="anchor"></a><code><span class="keyword">val</span> respond : <span>?&#8288;headers:Cohttp.Header.t</span> <span>&#45;&gt;</span> <span>?&#8288;code:Cohttp.Code.status_code</span> <span>&#45;&gt;</span> <a href="index.html#type-body">body</a> <span>&#45;&gt;</span> <a href="../../../opium_kernel/Opium_kernel__Rock/Response/index.html#type-t">Opium_kernel.Rock.Response.t</a></code></dt><dt class="spec value" id="val-respond'"><a href="#val-respond'" class="anchor"></a><code><span class="keyword">val</span> respond' : <span>?&#8288;headers:Cohttp.Header.t</span> <span>&#45;&gt;</span> <span>?&#8288;code:Cohttp.Code.status_code</span> <span>&#45;&gt;</span> <a href="index.html#type-body">body</a> <span>&#45;&gt;</span> <span><a href="../../../opium_kernel/Opium_kernel__Rock/Response/index.html#type-t">Opium_kernel.Rock.Response.t</a> Lwt.t</span></code></dt><dt class="spec value" id="val-create_stream"><a href="#val-create_stream" class="anchor"></a><code><span class="keyword">val</span> create_stream : unit <span>&#45;&gt;</span> <span>(<span>?&#8288;headers:Cohttp.Header.t</span> <span>&#45;&gt;</span> <span>?&#8288;code:Cohttp.Code.status_code</span> <span>&#45;&gt;</span> <span>unit Lwt.t</span> <span>&#45;&gt;</span> <span><a href="../../../opium_kernel/Opium_kernel__Rock/Response/index.html#type-t">Opium_kernel.Rock.Response.t</a> Lwt.t</span>)</span> * <span>(string <span>&#45;&gt;</span> unit)</span></code></dt><dt class="spec value" id="val-redirect"><a href="#val-redirect" class="anchor"></a><code><span class="keyword">val</span> redirect : <span>?&#8288;headers:Cohttp.Header.t</span> <span>&#45;&gt;</span> Uri.t <span>&#45;&gt;</span> <a href="../../../opium_kernel/Opium_kernel__Rock/Response/index.html#type-t">Opium_kernel.Rock.Response.t</a></code></dt><dt class="spec value" id="val-redirect'"><a href="#val-redirect'" class="anchor"></a><code><span class="keyword">val</span> redirect' : <span>?&#8288;headers:Cohttp.Header.t</span> <span>&#45;&gt;</span> Uri.t <span>&#45;&gt;</span> <span><a href="../../../opium_kernel/Opium_kernel__Rock/Response/index.html#type-t">Opium_kernel.Rock.Response.t</a> Lwt.t</span></code></dt></dl></div></body></html>